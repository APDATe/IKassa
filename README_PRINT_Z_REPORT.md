# IKassa
Внешняя компонента работы с кассовыми аппаратами 3в1

# Методы работы в 1С Предприятие 7.7

### Метод  ПечатьПоследнегоОтчетаЗакрытияСмены()

Данный метод выполняет печать последнего Z-Отчета на кассе и принимает следующие параметры

### Метод не имеет парамтеров

### Метод  ПечатьПоследнегоОтчетаЗакрытияСмены().Закрыть("http://192.168.111.212:37015/v1", "75928")
Данный метод закрывает документ и принимает параметры непосредственно в методе 

Параметр | Описание
---|---
URL:PORT | URL - адрес кассового аппарта с портом (должен всегда заканчиваться /v1 
Пин-код |  пароль кассира (указан в паспорте токена)

### Представление синтаксиса 1С Предприятие 7.7 Для печати чека по номеру

```1C
//Подключаем компоненту
МояКасса = СоздатьОбъект("AddIn.V7AlexEngineKassa");
//Создаем новый экземпляр класса ПечатьПоследнегоОтчетаЗакрытияСмены();	
Документ =  МояКасса.ПечатьПоследнегоОтчетаЗакрытияСмены();
//Заполняем параметры класса ПечатьПоследнегоОтчетаЗакрытияСмены();

//Выполняем метод Закрыть(string "URL", string "PinKod") класса ПечатьПоследнегоОтчетаЗакрытияСмены();
ответ = Документ.Закрыть("http://192.168.111.212:37015/v1", "75928");

```

### Метод Закрыть() любого класса возвращает следующие параметры

Параметр | Описание
---|---
КодОтвета | Коды ответа тип-число далее здесь приложу ссылку на описание кодов ответа 
Детали |  Описание кода ответа 
